<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Introducing Discrete Diffusion Forcing (D2F), a novel hybrid paradigm that enables Diffusion LLMs to surpass autoregressive models in inference speed for the first time, achieving up to 50x acceleration.">
    
    <!-- Open Graph meta tags for social sharing -->
    <meta property="og:title" content="D2F: Diffusion LLMs Can Now Outpace Autoregressive Models">
    <meta property="og:description" content="Meet Discrete Diffusion Forcing (D2F), a novel paradigm that makes Diffusion LLMs up to 2.5x faster than leading AR models, finally unlocking their parallel potential.">
    <meta property="og:image" content="assets/img/d2f/fig1_main_result.png"> <!-- Make sure this path is correct -->

    <title>D2F: Diffusion LLMs Can Do Faster-Than-AR Inference via Discrete Diffusion Forcing</title>
    
    <!-- Google Fonts for a clean, modern look -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">

    <style>
        /* Basic Reset and Body Styling */
        body {
            font-family: 'Inter', -apple-system, BlinkMacMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            line-height: 1.7;
            color: #333;
            background-color: #fdfdfd;
            margin: 0;
            padding: 20px;
        }

        /* Main Content Container */
        .container {
            max-width: 800px;
            margin: 20px auto;
            padding: 0 15px;
        }

        /* Header and Title */
        header {
            text-align: center;
            margin-bottom: 40px;
            border-bottom: 1px solid #e0e0e0;
            padding-bottom: 20px;
        }

        h1 {
            font-size: 2.5em;
            font-weight: 700;
            margin-bottom: 0.5em;
            color: #1a1a1a;
            line-height: 1.2;
        }

        /* Author and Affiliation Styling */
        .authors {
            font-size: 1.1em;
            color: #555;
            margin-bottom: 20px;
        }
        .authors span {
            display: block;
            margin-top: 5px;
            font-style: italic;
            font-size: 0.9em;
            color: #777;
        }

        /* Quick Links / Buttons */
        .links {
            margin-top: 20px;
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap; /* Allow buttons to wrap on smaller screens */
        }
        .links a {
            text-decoration: none;
            color: #fff;
            background-color: #007bff; /* Original blue */
            padding: 10px 20px;
            border-radius: 5px;
            font-weight: 600;
            transition: background-color 0.3s;
        }
        .links a:hover {
            background-color: #0056b3; /* Darker blue on hover */
        }
        /* Style for the 'black' buttons */
        .links a.black-button {
            background-color: #333; /* Dark grey/black */
        }
        .links a.black-button:hover {
            background-color: #000; /* Pure black on hover */
        }


        /* Main Article Content */
        article h3 {
            font-size: 1.8em;
            font-weight: 600;
            margin-top: 2.5em;
            margin-bottom: 1em;
            color: #222;
            border-bottom: 2px solid #007bff;
            padding-bottom: 5px;
        }

        p, ol, ul {
            font-size: 1.1em;
            margin-bottom: 1.5em;
        }
        
        strong {
            font-weight: 600;
            color: #000;
        }

        a {
            color: #007bff;
            text-decoration: none;
        }
        a:hover {
            text-decoration: underline;
        }
        
        ul, ol {
            padding-left: 25px;
        }
        
        li {
            margin-bottom: 0.8em;
        }

        /* Figure and Image/Video Styling */
        figure {
            margin: 40px 0;
            text-align: center;
        }
        figure img, figure video { /* MODIFIED: Applied style to both img and video */
            max-width: 100%;
            height: auto;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            border: 1px solid #eee;
        }
        figcaption {
            margin-top: 15px;
            font-size: 0.95em;
            color: #666;
            font-style: italic;
        }

        /* Code Block for Citation */
        pre {
            background-color: #f4f4f4;
            padding: 20px;
            border-radius: 5px;
            overflow-x: auto;
            border: 1px solid #ddd;
        }
        code {
            font-family: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier, monospace;
            font-size: 0.9em;
            color: #333;
        }
    </style>
</head>
<body>

    <div class="container">
        <header>
            <h1>D2F: Making Diffusion LLMs Faster Than Autoregressive Models</h1>
            
            <div class="authors">
                Xu Wang*, Chenkai Xu*, Yijie Jin, Jiachun Jin, Yanzhe Hu, and Zhijie Deng
                <span>Shanghai Jiao Tong University</span>
            </div>

            <div class="links">
                <a href="https://arxiv.org/abs/..." target="_blank" class="black-button">Paper</a> <!-- TODO: Replace with actual paper link -->
                <a href="https://github.com/zhijie-group/Discrete-Diffusion-Forcing" target="_blank" class="black-button">Code</a>
                <a href="https://huggingface.co/SJTU-Deng-Lab/D2F_Dream_Base_7B_Lora" target="_blank" class="black-button">D2F-Dream</a>
                <a href="https://huggingface.co/SJTU-Deng-Lab/D2F_LLaDA_Instruct_8B_Lora" target="_blank" class="black-button">D2F-LLaDA</a>
            </div>
        </header>

        <article>
            <figure>
                <video width="100%" autoplay loop muted playsinline>
                    <source src="assets/video/d2f_vs_ar_demo.mp4" type="video/mp4">
                    Your browser does not support the video tag. This video shows a side-by-side comparison of D2F and an AR model's generation speed.
                </video>
                <figcaption>
                    Real-time demo comparing the inference speed of our D2F-dLLM (left) and a baseline AR model (right). D2F generates text in parallel blocks, achieving significantly higher throughput.
                </figcaption>
            </figure>

            <p>Diffusion Large Language Models (dLLMs) have long promised a new era of text generation with their inherent ability to decode multiple tokens in parallel. However, in practice, open-source dLLMs have consistently lagged behind their autoregressive (AR) counterparts like LLaMA3 in inference speed, creating a major barrier to their adoption.</p>

            <p>Today, we are excited to introduce <strong>Discrete Diffusion Forcing (D2F)</strong>, a simple yet powerful strategy that shatters this speed limit. D2F introduces a novel AR-diffusion hybrid paradigm, achieving up to a <strong>2.5x speedup over leading AR models</strong> and a staggering <strong>50x acceleration over vanilla dLLMs</strong>, all while maintaining comparable generation quality.</p>
            
            <figure>
                <img src="assets/img/d2f/fig1_main_result.png" alt="Bar chart comparing inference throughput of D2F with other DLLMs and AR models.">
                <figcaption>D2F is the first open-source dLLM to decisively surpass similarly-sized AR models like LLaMA3 and Qwen2.5 in inference throughput (Tokens/Second).</figcaption>
            </figure>

            <h3>The Bottleneck: Why Were Diffusion LLMs Slow?</h3>
            <p>The promise of dLLMs lies in parallel decoding, but two fundamental issues have historically crippled their speed:</p>
            <ul>
                <li><strong>KV Cache Incompatibility:</strong> Standard dLLMs rely on <strong>bidirectional attention</strong>, where every token can see every other token. This holistic view is powerful but prevents the use of the Key-Value (KV) Cache, a critical optimization in AR models that saves massive amounts of redundant computation.</li>
                <li><strong>Strict Inter-Block Dependency:</strong> Early attempts to add caching by generating text in blocks were still inefficient. They required each block to be fully generated before starting the next, eliminating the potential for true parallel processing across blocks.</li>
            </ul>

            <h3>The D2F Solution: A Hybrid of Speed and Power</h3>
            <p>D2F overcomes these bottlenecks by fundamentally restructuring how dLLMs are trained and how they generate text. Hereâ€™s how it works.</p>

            <h4>1. The Architecture: Block-wise AR meets Parallel Diffusion</h4>
            <p>At its core, D2F transforms the generation process into a <strong>block-autoregressive</strong> framework. Text is generated in sequential blocks. The key architectural change is in the attention mechanism:</p>
            <ul>
                <li>Attention <em>within</em> a block remains <strong>bidirectional</strong>, preserving rich local context.</li>
                <li>Attention <em>between</em> blocks is made <strong>causal</strong>, meaning a block can only attend to previous, completed blocks.</li>
            </ul>
            <p>This hybrid design makes D2F fully compatible with the standard KV cache, instantly eliminating a major source of computational redundancy.</p>

            <h4>2. The Method: Asymmetric Distillation and Pipelined Inference</h4>
            <p>With this new architecture, D2F employs a two-pronged strategy for training and inference:</p>
            <p><strong>Training with Asymmetric Distillation:</strong> Instead of costly training from scratch, D2F uses an efficient distillation process. We take a powerful pre-trained dLLM (the "teacher") and distill its knowledge into our D2F model (the "student"). The teacher uses its full bidirectional view to make predictions, while the student learns to match those predictions using only its limited, block-wise causal view. This process effectively transfers the teacher's capabilities into a faster, cache-friendly architecture in just a few hours (e.g., 12 hours on 8 A100 GPUs).</p>
            
            <figure>
                <img src="assets/img/d2f/fig3_overview.png" alt="Diagram showing the asymmetric distillation process for D2F.">
                <figcaption>Overview of D2F training: the student model (with block-wise causal attention) learns to mimic a pre-trained teacher model (with full bidirectional attention).</figcaption>
            </figure>

            <p><strong>Inference with a Pipelined Parallel Decoder:</strong> This is where D2Fâ€™s speed truly comes from. Because D2F is trained to predict future blocks based on <strong>partially incomplete</strong> previous ones, it doesn't need to wait. During inference, it uses a dynamic pipeline:</p>
            <ul>
                <li>A new block is added to the pipeline as soon as its predecessor is only partially complete.</li>
                <li>Blocks begin in a conservative "semi-activated" state and transition to an aggressive "fully-activated" state once they have sufficient context from the block before them.</li>
            </ul>
            <p>This creates a highly efficient, asynchronous workflow where multiple blocks are refined in parallel, maximizing GPU utilization and dramatically boosting throughput.</p>

            <figure>
                <img src="assets/img/d2f/fig4_pipeline.png" alt="Visualization of the pipelined parallel decoding workflow.">
                <figcaption>D2F's pipelined decoding in action. New blocks are added dynamically and decoded in parallel, creating a continuous, high-throughput generation flow.</figcaption>
            </figure>

            <h3>Putting D2F to the Test: Performance Highlights</h3>
            <p>D2F sets a new standard for dLLM efficiency across multiple benchmarks.</p>
            <ul>
                <li><strong>Superior Efficiency Frontier:</strong> D2F operates on a significantly better throughput-performance curve. On GSM8K, our model achieves <strong>3.1x higher throughput</strong> than LLaMA3 while also attaining a better score.</li>
                <li><strong>Massive Acceleration:</strong> Compared to its baseline vanilla dLLM, D2F-LLaDA achieves up to a <strong>52.9x</strong> speedup on the MBPP benchmark and <strong>29.1x</strong> on HumanEval, with comparable accuracy.</li>
                <li><strong>State-of-the-Art Speed:</strong> Across math and code generation benchmarks, D2F consistently outperforms previous SOTA acceleration methods for dLLMs, often by a 2-3x margin in speed.</li>
            </ul>

            <figure>
                <img src="assets/img/d2f/fig2_tradeoff.png" alt="Graph showing the throughput vs. performance trade-off for D2F and other models.">
                <figcaption>Throughput vs. Performance trade-off. D2F models (blue data points) operate on a far more efficient frontier than baseline dLLMs and AR models (stars).</figcaption>
            </figure>

            <h3>Conclusion</h3>
            <p>Discrete Diffusion Forcing (D2F) represents a fundamental leap forward for diffusion-based language models. By forging a novel AR-diffusion hybrid paradigm, it overcomes the critical inference bottlenecks that have long held dLLMs back. For the first time, an open-source dLLM can not only match but significantly <strong>exceed the speed of highly optimized autoregressive models</strong>.</p>
            <p>This breakthrough establishes dLLMs as a practical, high-performance alternative for a wide range of text generation tasks, paving the way for new applications and further research into efficient, parallel-first language modeling.</p>

            <h3>Citation</h3>
            <p>If you find our work useful, please consider citing our paper:</p>
            <pre><code>@article{wang2025d2f,
  title={Diffusion LLMs Can Do Faster-Than-AR Inference via Discrete Diffusion Forcing},
  author={Wang, Xu and Xu, Chenkai and Jin, Yijie and Jin, Jiachun and Hu, Yanzhe and Deng, Zhijie},
  journal={arXiv preprint},
  year={2025}
}</code></pre>
        </article>
    </div>

</body>
</html>
